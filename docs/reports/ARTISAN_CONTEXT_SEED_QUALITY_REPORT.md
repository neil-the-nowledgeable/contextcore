# Artisan Context Seed Quality Validation Report

**File reviewed:** `wayfinder/out/manifest-generate-ingestion/artisan-context-seed.json`  
**Generated by:** PlanIngestionWorkflow (plan-ingestion)  
**Date:** 2026-02-12

## Executive Summary

The artisan-context-seed.json is a rich artifact suitable for driving the startd8 artisan workflow. It contains plan structure, tasks, architectural context, and design calibration. However, it lacks **explicit references to ContextCore export outputs** and **artifact-type schema metadata** needed for programmatic onboarding and observability artifact generation.

| Category | Score | Notes |
|----------|-------|-------|
| Plan structure | 5/5 | Features, tasks, dependency graph, labels complete |
| Architectural context | 5/5 | Objectives, constraints, preferences well-defined |
| Design calibration | 5/5 | Per-task depth, sections, complexity |
| **Export linkage** | 2/5 | No artifact manifest path, no CRD ref in seed |
| **Artifact schema** | 1/5 | Missing artifact type → generator param mapping |
| **Provenance chain** | 2/5 | Ingestion provenance only; export provenance not embedded |
| **Coverage gaps** | 3/5 | Plan mentions 77 artifacts; context files have 6 — mismatch |

---

## Quality Strengths

### 1. Plan Structure
- **23 features** with clear dependency graph (F-001 through F-023)
- **23 tasks** (PI-001 through PI-023) with story points, priority, labels
- Target files explicitly listed per feature
- Dependency clusters identified (F-001 root with F-002, F-003, F-004)

### 2. Architectural Context
- **Objectives** with key results (artifact_types_covered, generator_test_coverage, etc.)
- **Constraints** with severity and scope (C-NO-ABORT-ALL, C-UNIFORM-SIGNATURES)
- **Preferences** (PREF-YAML-OUTPUT, PREF-JINJA-TEMPLATES)
- **Focus areas** with reason and until date

### 3. Design Calibration
- Per-task `depth_tier`, `sections`, `max_output_tokens`, `complexity`
- Standard sections: Overview, Architecture, Data Model, Error Handling, Testing Strategy

### 4. Domain Concepts
- Artifact types enumerated: ServiceMonitor, PrometheusRule, LokiRule, SLO, NotificationPolicy, Runbook, Dashboard
- Domain concepts: "7 types × 11 services" (Online Boutique reference)

---

## Quality Gaps (Programmatic Onboarding)

### Gap 1: No Artifact Manifest Reference in Seed
**Impact:** High. The artisan workflow must know where to load the artifact manifest.

**Current:** `artifacts` section only has:
```json
"artifacts": {
  "plan_document_path": "...",
  "review_config_path": "..."
}
```

**Needed:** 
```json
"artifacts": {
  "plan_document_path": "...",
  "review_config_path": "...",
  "artifact_manifest_path": "out/contextcore-export/wayfinder-artifact-manifest.yaml",
  "project_context_path": "out/contextcore-export/wayfinder-projectcontext.yaml"
}
```

### Gap 2: No Artifact Type → Generator Mapping
**Impact:** Critical. Generators need to know:
- Which parameters each artifact type accepts
- Output file conventions (e.g., `*-service-monitor.yaml`)
- Template name mapping

**Current:** Plan describes 7 types but no schema for:
- `dashboard` → `parameters.dashboardPlacement`, `parameters.datasources`
- `prometheus_rule` → `parameters.alertSeverity`, `parameters.availabilityThreshold`
- `service_monitor` → `parameters.metricsInterval`, `parameters.namespace`

**Needed:** `artifact_type_schema` in seed with parameter keys and validation hints.

### Gap 3: Provenance Chain Broken
**Impact:** Medium. Audit trail from manifest → export → ingestion → seed is incomplete.

**Current:** 
- Ingestion provenance (ingestion-provenance.json) tracks context file checksums
- Export provenance (provenance.json from `--emit-provenance`) is separate
- Seed does not reference or embed export provenance

**Needed:** Seed should include `export_provenance_ref` or embed checksums of artifact manifest and project context.

### Gap 4: Plan vs. Context Mismatch
**Impact:** Medium. Plan references "77 artifacts (7 × 11 services) for Online Boutique" but context files (wayfinder-artifact-manifest.yaml) contain 6 artifacts for wayfinder-core.

**Explanation:** The plan is generic (Online Boutique example); the context files are wayfinder-specific. This is expected when using a generic plan with project-specific context. Document this clearly.

### Gap 5: No Output Path Conventions
**Impact:** Medium. Where should generated artifacts be written?

**Current:** Plan mentions `output-dir` but not conventions like:
- `k8s/observability/service-monitors/`
- `grafana/provisioning/dashboards/`
- `mimir/rules/`

**Needed:** `output_path_conventions` mapping artifact type to default output path.

### Gap 6: Semantic Conventions Not in Seed
**Impact:** Low. Artifact manifest includes `semanticConventions` (attribute namespaces, metrics, query templates) but seed does not. Generators creating dashboards need these for TraceQL/LogQL panels.

**Needed:** Propagate `semanticConventions` from artifact manifest into seed.

---

## Recommendations

### 1. Enhance `contextcore manifest export` Command
Add `--emit-onboarding` flag that writes `onboarding-metadata.json`:

```json
{
  "version": "1.0.0",
  "schema": "contextcore.io/onboarding-metadata/v1",
  "artifact_manifest_path": "wayfinder-artifact-manifest.yaml",
  "project_context_path": "wayfinder-projectcontext.yaml",
  "provenance": { ... },
  "artifact_types": {
    "dashboard": { "output_ext": ".json", "output_convention": "grafana/dashboards/{target}-dashboard.json" },
    "service_monitor": { "output_ext": ".yaml", "output_convention": "k8s/observability/{target}-service-monitor.yaml" }
  },
  "coverage_gaps": [ "wayfinder_core-dashboard", ... ],
  "semantic_conventions": { ... }
}
```

### 2. Ingestion Workflow: Merge Onboarding Metadata
When plan ingestion runs with context files from ContextCore export:
- If `onboarding-metadata.json` exists in the export directory, merge its contents into the artisan-context-seed.json `artifacts` and `onboarding` sections.

### 3. Seed Schema Extension
Add optional `onboarding` top-level key to artisan-context-seed.json:

```json
{
  "onboarding": {
    "artifact_manifest_path": "...",
    "project_context_path": "...",
    "artifact_type_schema": { ... },
    "output_path_conventions": { ... },
    "semantic_conventions": { ... },
    "export_provenance_checksum": "..."
  }
}
```

---

## Appendix: Artifact Manifest Contract Mapping

| Artifact Type | Parameters (from wayfinder-artifact-manifest) | Output Convention |
|---------------|------------------------------------------------|------------------|
| dashboard | criticality, dashboardPlacement, datasources, risks | `{target}-dashboard.json` |
| prometheus_rule | alertSeverity, availabilityThreshold, latencyThreshold | `{target}-prometheus-rules.yaml` |
| slo_definition | availability, latencyP99, errorBudget | `{target}-slo.yaml` |
| service_monitor | metricsInterval, namespace | `{target}-service-monitor.yaml` |
| loki_rule | logSelectors, recordingRules | `{target}-loki-rules.yaml` |
| notification_policy | alertChannels, owner, owners | `{target}-notification.yaml` |
| runbook | risks, escalationContacts | `{target}-runbook.md` |
